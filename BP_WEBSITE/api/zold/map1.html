<!DOCTYPE html>
<html>
<head>
<title>Simple Map</title>
<meta name="viewport" content="initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<script src="https://www.gstatic.com/firebasejs/3.6.0/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.5.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.5.2/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.5.2/firebase-messaging.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">    
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <style type="text/css">
      html, body { height: 100%; margin: 0; padding: 0; }
      #map { height: 100%; }
    </style>
<script>
  // Initialize Firebase
  var config = {
     apiKey: "AIzaSyBQchZ2V6xpY-SgQ9Z20-wFsL4xDx-Rw3w",
    authDomain: "busplanner-f496d.firebaseapp.com",
    databaseURL: "https://busplanner-f496d.firebaseio.com",
    storageBucket: "busplanner-f496d.appspot.com",
    messagingSenderId: "771650212189"
  };
  firebase.initializeApp(config);

firebase.auth().onAuthStateChanged(function(user) {
    if (user) {
        console.log ("logged");
        email = user.email;
        console.log (email);    
    } else {
        console.log ("Not logged");
    }
});

function initMap() {
  var uluru = {lat: 64.01, lng: 19.05};
          var map = new google.maps.Map(document.getElementById('map'), {
            center: {
              lat: 64.01,
              lng: 19.05
            },
            zoom: 14,
            styles: [{
              featureType: 'poi',
              stylers: [{
              visibility: 'on'
            }] // Turn off points of interest.
            }, {
              featureType: 'transit.station',
              stylers: [{
              visibility: 'on'
            }] // Turn off bus stations, train stations, etc.
            }],
            disableDoubleClickZoom: false
	
          });
		 
		//HERE THE INFO FROM DB 
		var contentString = '<div id="content">'+
            '<div id="siteNotice">'+
            '</div>'+
            '<h1 id="firstHeading" class="firstHeading">Uluru</h1>'+
            '<div id="bodyContent">'+
            '<p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large ' +
            'sandstone rock formation in the southern part of the '+
            'Northern Territory, central Australia. It lies 335&#160;km (208&#160;mi) '+
            'south west of the nearest large town, Alice Springs; 450&#160;km '+
            '(280&#160;mi) by road. Kata Tjuta and Uluru are the two major '+
            'features of the Uluru - Kata Tjuta National Park. Uluru is '+
            'sacred to the Pitjantjatjara and Yankunytjatjara, the '+
            'Aboriginal people of the area. It has many springs, waterholes, '+
            'rock caves and ancient paintings. Uluru is listed as a World '+
            'Heritage Site.</p>'+
            '<p>Attribution: Uluru, <a href="https://en.wikipedia.org/w/index.php?title=Uluru&oldid=297882194">'+
            'https://en.wikipedia.org/w/index.php?title=Uluru</a> '+
            '(last visited June 22, 2009).</p>'+
            '</div>'+
            '</div>';
   
  var query = firebase.database().ref("UserRequest").orderByKey();
query.once("value")
  .then(function(snapshot) {
    
    for (var i = 1; i <= 2; ++i) {
   var lat = snapshot.child("UserRequest"+i+"/Latitude").val(); 
     
      var long = snapshot.child("UserRequest"+i+"/Longitude").val(); 
       
         var status = snapshot.child("UserRequest"+i+"/Status").val(); 
          var latLng = new google.maps.LatLng(lat,long);
                     
                    var infowindow = new google.maps.InfoWindow({
            content: status
        });
                    var marker = new google.maps.Marker({
                            position: latLng,
                        map: map,
						title:status
                    });
                     marker.addListener('click', function() {
            infowindow.open(map, marker);
        });
  }
});
		  //here to read from db THE MARK IS FOR EACH POINT
		  //TITLE SHOULD BE UNIQUE
}
    google.maps.event.addDomListener(window, "load", initMap);
</script>
  </head>
  <body>
<div id="map"></div>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAHNVxKQAn4wn4sqz_1i5yKIBenoiyWU5I&&libraries=visualization&callback=initMap"
async defer></script>
  </body>
</html>